<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<!--[if lt IE 9]>
<script type="text/javascript" src="../lib/html5.js"></script>
<script type="text/javascript" src="../lib/respond.min.js"></script>
<script type="text/javascript" src="../lib/PIE_IE678.js"></script>
<![endif]-->
<link href="../css/H-ui.min.css" rel="stylesheet" type="text/css" />
<link href="../css/H-ui.login.css" rel="stylesheet" type="text/css" />
<link href="../css/style.css" rel="stylesheet" type="text/css" />
<link href="../lib/Hui-iconfont/1.0.1/iconfont.css" rel="stylesheet" type="text/css" />
<!--[if IE 6]>
<script type="text/javascript" src="http://lib.h-ui.net/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
	<script type="text/javascript" src="../js/loadExtendFile.js"></script>
</script>
<title>后台登录 </title>
<meta name="keywords" content="">
<meta name="description" content="">
</head>
<body>
<!--<input type="hidden" id="TenantId" name="TenantId" value="" />-->
<div class="header" style="height:80px;background-color:#FFFFFF;">
	<div style="margin: 15px 100px;">
		<img src="../images/edian/logo.png" width="50px;"/>
		<span class="f-18" style="margin: -10px 15px;border-right: 1px solid;display: inline-block;height: 30px;"></span>
		<span class="f-18">E店后台管理系统</span>
	</div>
</div>
<div class="loginWraper" style="background-image: url(../images/edian/login.png);">
	<div id="loginform" class="loginBox" style="background: #FFFFFF;width: 350px;height: 300px;padding-top: 0;border-radius: 3px;left: 85%;">
    <form class="form form-horizontal"  method="post">
      <div class="row cl">
        <div class="" style="width: 280px;height:38px;line-height:38px;margin: 0 auto;font-size: 20px;color: #1385FA;">
        	后台管理系统登录
        </div>
      </div>
      <div class="row cl">
        <div class="" style="width: 280px;height:38px;margin: 0 auto;border: 1px solid #B5B3B3;border-radius: 5px;">
        	<label class="" style="font-size: 24px;margin:0 10px;"><i class="Hui-iconfont">&#xe60d;</i></label>
          	<input id="account" onkeyup="clearErrMsg('account');" name="" type="text" placeholder="请输入账号" style="width: 180px;height:25px;border: none;font-size: 16px;line-break: 16px;margin-bottom: 6px;">
          	<label id="clear_account" onclick="clearAccount();" style="font-size: 20px;margin:0 10px;vertical-align:text-bottom;cursor:pointer;display: none;"><i class="Hui-iconfont">&#xe60b;</i></label>
        </div>
      </div>
      <div class="row cl">
        <div class="" style="width: 280px;height:38px;margin: 0 auto;border: 1px solid #B5B3B3;border-radius: 5px;">
        	<label class="" style="font-size: 24px;margin:0 10px;"><i class="Hui-iconfont">&#xe60e;</i></label>
          	<input id="password" onkeyup="clearErrMsg('password');" name="" type="password" placeholder="请输入密码" class="" style="width: 180px;border: none;font-size: 16px;line-break: 16px;margin-bottom: 6px;">
          	<label id="clear_password" onclick="clearPassword();" style="font-size: 20px;margin:0 10px;vertical-align:text-bottom;cursor:pointer;display: none;"><i class="Hui-iconfont">&#xe60b;</i></label>
        </div>
      </div>
      
      <div class="row cl" style="height: 38px;margin-top: 5px;"> 
      	<div>
	        <div id="errorTip" style="width: 280px;height:38px;line-height:38px;margin: 0 auto;font-size: 16px;color: red;">
        	
        	</div>
      	</div>
      </div>
      <div class="row cl" style="margin-top: 12px;">
        <div class="" onclick="login()" style="width: 280px;height:38px;margin: 0 auto;border: 1px solid #B5B3B3;border-radius: 5px;background: #037FFD;font-size: 18px;line-height: 38px;text-align: center;cursor: pointer;">
        	<span style="color: #FFFFFF;">登录</span>
        </div>
      </div>
    </form>
    </div>
</div>
<!--<div class="loginWraper">
  <div id="loginform" class="loginBox">
    <form class="form form-horizontal"  method="post">
      <div class="row cl">
        <label class="form-label col-3"><i class="Hui-iconfont">&#xe60d;</i></label>
        <div class="formControls col-8">
          <input id="account" name="" type="text" placeholder="账户" class="input-text size-L">
        </div>
      </div>
      <div class="row cl">
        <label class="form-label col-3"><i class="Hui-iconfont">&#xe60e;</i></label>
        <div class="formControls col-8">
          <input id="password" name="" type="password" placeholder="密码" class="input-text size-L">
        </div>
      </div>
      <div class="row cl"> 
      	<div style="display: none;" id="errorDiv">
      		<label class="form-label col-3">&nbsp;</label>
	        <div class="formControls col-8" id="errorTip" style="color:red">
	         		
	        </div>
      	</div>
      </div>
      <div>
        <div class="formControls col-8 col-offset-3">
          <input name="" type="button" onclick="login()"  class="btn btn-success radius size-L" value="&nbsp;登&nbsp;&nbsp;&nbsp;&nbsp;录&nbsp;">
        </div>
      </div>
    </form>
  </div>
</div>-->
<div class="footer" style="background-color: #FFFFFF;color: #000000;font-size: 16px;">Copyright 雷石宇</div>
<script type="text/javascript" src="../lib/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="../js/H-ui.js"></script> 
<script type="text/javascript" src="../lib/layer/1.9.3/layer.js"></script> 
<script>
	document.onkeydown=function(event){
        var e = event || window.event || arguments.callee.caller.arguments[0];
        if(e && e.keyCode==13){ // enter 键
            login();
        }
    }; 
    
	function login(){
		var account = $("#account").val();
		var pwd = $("#password").val();
		var jsonData ={"account":account,"password":pwd};
		$.ajax({
			type:"GET",
			url:request_url+"login",
			async:false,
			data:jsonData,
			success:function(data){
				var obj = eval(data);
				if(obj.ret == 1000){			
					//登录成功，
					localStorage.setItem("account",account);
					findPermission();
				}else{
					$("#errorTip").html(data.msg);
				}
			}
		});
	}
	
	function clearErrMsg(type){
		$("#errorTip").html("");
		if(type == 'account'){
			if($("#account").val().length > 0){
				$('#clear_account').show();
			}else{
				$('#clear_account').hide();
			}
		}else{
			if($("#password").val().length > 0){
				$('#clear_password').show();
			}else{
				$('#clear_password').hide();
			}
		}
	}
	
	function clearAccount(){
		$("#account").val("");
		$('#clear_account').hide();
	}
	
	function clearPassword(){
		$("#password").val("");
		$('#clear_password').hide();
	}
	
	function findPermission(){
	var account = localStorage.getItem("account");
		var url = request_url+"permission/getPermssion";
		var jsonData = {"account":account};
		var type="GET";
		
		ajaxRequest.ajax(url,jsonData,type,function(data){
			var obj = eval(data);
			if(obj.ret == '1000') {
				localStorage.setItem("permissionInfo",JSON.stringify(obj.model));
				window.location.href="index.html";
			}else{
				layer.msg(obj.msg, {
					icon: 5,
					time: 1000
				});
			}
		});
	}
</script>
</body>
</html>